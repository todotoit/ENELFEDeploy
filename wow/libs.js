function rgb2hex(a){return a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),a&&4===a.length?"0x"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""}function bufferToCanvas(a){return{x:a.x*(APP.W-APP.max_r),y:a.y*APP.H}}function canvasToBuffer(a){return{x:a.x/APP.W,y:a.y/APP.H}}function svgToCanvas(a,b,c){a instanceof jQuery&&(a=a.get(0));var a,d=b.getContext("2d"),e=document.createElement("div"),f=a,g=new Image;e.appendChild(f.cloneNode(!0)),a="data:image/svg+xml;base64,"+window.btoa(e.innerHTML),g.src=a,g.onload=function(){d.clearRect(0,0,b.width,b.height),d.drawImage(g,0,0),c&&c(b)}}Number.prototype.map=function(a,b,c,d){return(this-a)*(d-c)/(b-a)+c},function(a){function b(a,b){e=a,f=b,g=new WebSocket("ws://"+e+":"+f+"/Skeleton"),g.onopen=function(a){console.log("connected")},g.onmessage=function(a){h&&h(a.data)},g.onerror=function(a){console.error(a.data)}}function c(a){g.send(JSON.stringify(a))}function d(a){h=a}var e,f,g,h;a("body").keypress(function(a){var b=a.which;switch(console.log(b),b){case 114:c({command:"reset"});break;case 49:c({command:"translationx",value:-.1});break;case 50:c({command:"translationx",value:.1});break;case 51:c({command:"translationz",value:-.1});break;case 52:c({command:"translationz",value:.1});break;case 53:c({command:"scale",value:-.1});break;case 54:c({command:"scale",value:.1})}}),window.sok={},window.sok.init=b,window.sok.send=c,window.sok.onData=d}(window.jQuery),function(){function a(a,b){g=a,h=a.children,i=h.length,j=b.min_r,k=b.max_r}function b(){}function c(a,b,c){if(!n){m[a]?m[a]:null;m[a]=[b,c];for(var e=0;i>e;++e){var f=h[e],g=f.x-b,o=f.y-c;if(l>g*g&&l>o*o&&!f.lock){f.lock=!0,f.used||(f.used=!0,f.ox=f.x,f.oy=f.y);var p=(.75-1.5*Math.random(),.75-1.5*Math.random(),1.5*Math.random()),q=f.tint;TweenMax.set(f,{tint:parseInt(16729735)});var r=f.width.map(j,k,200,300);TweenMax.to(f,p,{overwrite:!0,physics2D:{velocity:r,angle:360*Math.random(),accelerationAngle:180,friction:.1},colorProps:{tint:q,format:"number"},onComplete:d,onCompleteParams:[f,f.ox,f.oy]})}}}}function d(a,b,c){var d=Math.random()+2;Math.random()+2;a.lock=!1,TweenMax.to(a,d+.1*a.width,{delay:0,x:b,y:c,ease:Expo.easeInOut})}function e(){n=!0;for(var a=0;i>a;++a){var b=h[a];b.lock=!1,b.used=!1,TweenMax.killTweensOf(b)}}function f(){n=!1}window.interakt={};var g,h,i,j,k,l=600,m={},n=!1;window.interakt.init=a,window.interakt.loop=b,window.interakt.pause=e,window.interakt.restore=f,window.interakt.addCursor=c}(),function(){function a(a){e=a.width/2,f=a.height/2,a.addChild(h),g=setInterval(function(){for(var a in i){var b=i[a];h.removeChild(b.sp1),h.removeChild(b.sp2),i[a]=null}},1e4)}function b(a){var b,e=a.id;d(a),a.handLeft&&(b=c(a.handLeft),window.interakt.addCursor(e,b.x,b.y)),a.handRight&&(b=c(a.handRight),window.interakt.addCursor(e,b.x,b.y))}function c(a){var b=a.x*e+e,c=-1*a.z*f+f;return{x:b,y:c}}function d(a){var b=i[a.id];if(!b){console.log("new sprite"),f=new PIXI.Graphics,h.addChild(f),e=new PIXI.Graphics,h.addChild(e);var d=l[k];k++,k>=l.length&&(k=0),b={sp1:e,sp2:f,c:d},i[a.id]=b}var e=b.sp1,f=b.sp2;e.clear(),f.clear(),e.beginFill(b.c),f.lineStyle(3,b.c);for(var g,m=0;m<j.length;++m){var n=j[m],o=n[0];g=c(a[o]),e.drawCircle(g.x,g.y,10),f.moveTo(g.x,g.y);for(var p=0;p<n.length;++p){var q=n[p];g=c(a[q]),e.drawCircle(g.x,g.y,10),p>0&&f.lineTo(g.x,g.y)}}}var e,f,g,h=new PIXI.Container,i={},j=[["handLeft","elbowLeft","shoulderLeft","spineShoulder","shoulderRight","elbowRight","handRight"],["head","spineShoulder","spineBase"],["ankleLeft","kneeLeft","spineBase","kneeRight","ankleRight"]],k=0,l=[16711680,65280,255,1044480,4080,983280];window.sok.onData=function(a){for(var c=0;c<a.length;++c)b(a[c])},window.skeleton={},window.skeleton.init=a,window.skeleton.toInterakt=b}(),window.svgToCanvas=svgToCanvas;